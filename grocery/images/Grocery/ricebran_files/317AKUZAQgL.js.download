'use strict';mix_d("StoreNavigationCards__store-subnav-desktop:store-subnav-desktop__4aT8ArTZ","exports tslib @c/browser-operations @c/browser-window @c/scoped-dom @c/metrics @c/aui-untrusted-ajax @c/logger @c/dom @c/remote-operations".split(" "),function(F,f,O,P,Q,R,S,T,G,U){function r(b){return b&&"object"===typeof b&&"default"in b?b:{"default":b}}var V=r(O),y=r(P),W=r(Q),H=r(R),X=r(S),Y=r(T),A=r(G),Z=r(U),t=function(){function b(){}b.resetMetricsEmitted=function(){b.metricsEmitted.clear()};b.hasMetric=
function(a){return this.metricsEmitted.has(a)};b.addMetric=function(a){this.metricsEmitted.add(a)};b.metricsEmitted=new Set;return b}(),I=function(){function b(a,c){this.startTimeInMs=Date.now();this.metricName=a+"_"+c}b.prototype.endTimerAndPublishToCSM=function(){H["default"].count(this.metricName,Date.now()-this.startTimeInMs)};b.prototype.endTimerWithSuffixAndPublishToCSM=function(a){H["default"].count(this.metricName+"_"+a,Date.now()-this.startTimeInMs)};return b}(),J=function(){function b(a,
c){this.startTimeInMs=Date.now();this.metricName=a+"_time_"+c}b.prototype.endTimerAndGetMetricValueOrNull=function(){if(t.hasMetric(this.metricName))return null;var a=Date.now()-this.startTimeInMs;t.addMetric(this.metricName);return{key:this.metricName,value:a,unit:"Milliseconds"}};return b}(),aa=function(){function b(a,c){c||(c="unknown");this.metricName=a+"_impression_"+c;t.hasMetric(this.metricName)?this.metricValues=[]:(this.metricValues=[{key:this.metricName,value:1}],t.addMetric(this.metricName))}
b.prototype.addMetricValue=function(a){a=this.metricName+"_"+a;t.hasMetric(a)||(this.metricValues.push({key:a,value:1}),t.addMetric(a))};b.prototype.getMetricValues=function(){return this.metricValues};b.prototype.createCloudwatchRequestOrNull=function(){return 0<this.metricValues.length?{metricValues:this.metricValues}:null};return b}(),ba=function(){function b(a,c){this.metricName=a+"_bool_"+c;t.hasMetric(this.metricName)?this.metricValues=[]:(this.metricValues=[{key:this.metricName,value:1}],t.addMetric(this.metricName))}
b.prototype.getMetricValues=function(){return this.metricValues};return b}(),ca=function(){function b(a){this.openTimers=[];this.definedMetricValues=[];this.metricPrefix=a}b.prototype.createAndAddOpenTimer=function(a){a=new J(this.metricPrefix,a);this.openTimers.push(a)};b.prototype.createAndAddImpressionMetric=function(a){var c;a=(new aa(this.metricPrefix,a)).getMetricValues();(c=this.definedMetricValues).push.apply(c,f.__spread(a))};b.prototype.createAndAddBooleanMetric=function(a){var c;a=(new ba(this.metricPrefix,
a)).getMetricValues();(c=this.definedMetricValues).push.apply(c,f.__spread(a))};b.prototype.addDefinedMetric=function(a){this.definedMetricValues.push(a)};b.prototype.batchPostMetrics=function(a){var c,d,e=[];try{for(var k=f.__values(this.openTimers),h=k.next();!h.done;h=k.next()){var l=h.value.endTimerAndGetMetricValueOrNull();l&&e.push(l)}}catch(p){var v={error:p}}finally{try{h&&!h.done&&(c=k.return)&&c.call(k)}finally{if(v)throw v.error;}}try{for(var n=f.__values(this.definedMetricValues),g=n.next();!g.done;g=
n.next())e.push(g.value)}catch(p){var m={error:p}}finally{try{g&&!g.done&&(d=n.return)&&d.call(n)}finally{if(m)throw m.error;}}0!==e.length&&(this.openTimers=[],this.definedMetricValues=[],a({metricValues:e}))};return b}(),w=new Map,B=function(){function b(a){var c=this,d=new Promise(function(e){c.unlockFunction=e});b.globalPromiseLockMap.set(a,d)}b.exists=function(a){return b.globalPromiseLockMap.has(a)};b.getPromiseForKey=function(a){return b.globalPromiseLockMap.get(a)};b.reset=function(){b.globalPromiseLockMap.clear()};
b.prototype.unlock=function(){this.unlockFunction()};b.globalPromiseLockMap=new Map;return b}(),K=function(){function b(){}b.extractFlyoutKeyDataFromHTMLElement=function(a){a=null===a||void 0===a?void 0:a.split(":",4);return void 0===a||3>a.length?{id:"",url:""}:{id:a[2],url:a[1]}};b.getHTMLForSubnavKey=function(a,c){var d;return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(e){switch(e.label){case 0:return B.exists(a.url)?[4,Promise.race([B.getPromiseForKey(a.url),
new Promise(function(k){return setTimeout(k,7E3)})])]:[3,2];case 1:return e.sent(),[2,null!==(d=w.get(a.id))&&void 0!==d?d:'<div style="color:#565959!important;white-space:normal;font-size:13px;text-align:center;padding:25px">An error has occurred, please refresh the page.</div>'];case 2:if(w.has(a.id))return[2,w.get(a.id)];w.set(a.id,'<div style="color:#565959!important;white-space:normal;font-size:13px;text-align:center;padding:25px">An error has occurred, please refresh the page.</div>');return[4,
b.makeAjaxCallAndPerformCaching(a.url,c)];case 3:return e.sent(),[2,w.get(a.id)]}})})};b.makeAjaxCallAndPerformCaching=function(a,c){return f.__awaiter(this,void 0,void 0,function(){var d,e,k,h,l=this;return f.__generator(this,function(v){d=new I("dsk_sn","ajax_flyout");e=new J("dsk_sn","ajax_flyout");k={timeout:7E3,accepts:"application/json"};h=new B(a);return[2,X["default"].get(a,k).then(function(n){return f.__awaiter(l,void 0,void 0,function(){var g,m,p;return f.__generator(this,function(C){g=
n.responseBody;for(m in g)g.hasOwnProperty(m)&&g[m].hasOwnProperty("html")&&w.set(m,g[m].html);h.unlock();d.endTimerWithSuffixAndPublishToCSM("okay");p=e.endTimerAndGetMetricValueOrNull();null!=p&&c.addDefinedMetric(p);return[2]})})}).catch(function(n){return f.__awaiter(l,void 0,void 0,function(){return f.__generator(this,function(g){Y["default"].log("Call to "+a+" failed with error "+n,"ERROR");h.unlock();d.endTimerWithSuffixAndPublishToCSM("error");return[2]})})})]})})};return b}(),q;(function(b){b.LOADING=
"LOADING";b.LOADED="LOADED";b.ERROR="ERROR";b.UNDEFINED="UNDEFINED"})(q||(q={}));var x;(function(b){b.SUCCESS="success";b.FAIL="fail";b.UNCHANGED="unchanged";b.UNKNOWN="unknown"})(x||(x={}));var D=q,da=function(){function b(a){this.subnavFlyoutParentElement=a;this.dropdownContentElement=a.getElementsByClassName("_store-subnav-desktop_style_dropdown-content__3mFih")[0];this.dropdownOpener=a.getElementsByClassName("_store-subnav-desktop_style_dropdown-opener__28qqM")[0];this.dropdownContentContainer=
a.getElementsByClassName("_store-subnav-desktop_style_dropdown-content-container__d2ykN")[0];this.dropdownIcon=a.getElementsByClassName("_store-subnav-desktop_style_dropdown-icon__3MVNe")[0];this.dropdownIconImage=a.getElementsByClassName("_store-subnav-desktop_style_dropdown-icon-image__17pjG")[0];this.arrowContainer=a.getElementsByClassName("_store-subnav-desktop_style_arrow-container__1Q-xY")[0];this.isRTL="rtl"===A["default"].cardRoot.ownerDocument.dir}b.prototype.alignFlyoutArrow=function(){this.arrowContainer.style.left=
this.dropdownIcon?this.dropdownIcon.offsetLeft+"px":this.dropdownIconImage.offsetLeft+"px";this.arrowContainer.style.right="auto";this.arrowContainer.offsetLeft+this.arrowContainer.offsetWidth+28>y["default"].innerWidth&&(this.arrowContainer.style.left="auto",this.arrowContainer.style.right="28px");this.arrowContainer.style.top=this.dropdownOpener.offsetTop+this.dropdownContentContainer.offsetTop-7+"px";this.arrowContainer.classList.remove("aok-hidden")};b.prototype.alignDropdownFlyout=function(){this.dropdownOpener.style.minWidth=
this.subnavFlyoutParentElement.offsetWidth+28+"px";if(this.isRTL)if(0>this.subnavFlyoutParentElement.offsetLeft-2)this.dropdownOpener.style.left="2px",this.dropdownOpener.style.right="auto";else{this.dropdownOpener.style.left="auto";var a=y["default"].innerWidth-this.subnavFlyoutParentElement.getBoundingClientRect().right;this.dropdownOpener.style.right=a+"px"}else this.subnavFlyoutParentElement.offsetLeft+this.dropdownOpener.offsetWidth+2>y["default"].innerWidth?(this.dropdownOpener.style.left="auto",
this.dropdownOpener.style.right="2px"):(this.dropdownOpener.style.left=this.subnavFlyoutParentElement.offsetLeft+"px",this.dropdownOpener.style.right="auto");this.dropdownOpener.classList.remove("aok-hidden")};b.prototype.getRawNavKey=function(){return this.subnavFlyoutParentElement.dataset.flyoutKey};b.prototype.getReftag=function(){var a=this.subnavFlyoutParentElement.dataset.relUrl;return a?a.split("ref=",2)[1]:this.subnavFlyoutParentElement.dataset.backupRefmarker};b.prototype.getFlyoutState=
function(){var a=this.subnavFlyoutParentElement.dataset.flyoutLoadState;return a&&q[a]?q[a]:q.UNDEFINED};b.prototype.setHTMLAndFlyoutStateForL1FlyoutAndGetNextState=function(a){this.dropdownContentElement.innerHTML=a;a='<div style="color:#565959!important;white-space:normal;font-size:13px;text-align:center;padding:25px">An error has occurred, please refresh the page.</div>'===a?D.ERROR:D.LOADED;return this.subnavFlyoutParentElement.dataset.flyoutLoadState=a};return b}(),ea=function(){function b(a){var c=
this;this.storeSubnavContainer=a;this.storeSubnavL1Nodes=Array.from(a.querySelectorAll("._store-subnav-desktop_style_l1-node-container__1lw2h"));var d=G.unscope(a),e=d.parentNode;this.storeSubnavPlaceholder=A["default"].createElement("div");this.storeSubnavPlaceholder.classList.add("_store-subnav-desktop_style_store-subnav-placeholder__1I13X");this.storeSubnavPlaceholder.style.height=a.clientHeight+"px";e.insertBefore(this.storeSubnavPlaceholder,d);this.storeSubnavResizeObserver=new ResizeObserver(function(k){c.storeSubnavContainer.style.width=
k[0].contentRect.width+"px"});this.isRTL="rtl"===A["default"].cardRoot.ownerDocument.dir;this.toggleL1NodeVisibilityOnOverflow()}b.prototype.setFocus=function(){this.storeSubnavContainer.classList.add("_store-subnav-desktop_style_subnav-focus__1DbBY")};b.prototype.clearFocus=function(){this.storeSubnavContainer.classList.remove("_store-subnav-desktop_style_subnav-focus__1DbBY")};b.prototype.setSticky=function(){this.storeSubnavContainer.classList.add("_store-subnav-desktop_style_subnav-sticky__227qt");
this.storeSubnavPlaceholder.style.display="block";this.storeSubnavResizeObserver.observe(this.storeSubnavPlaceholder)};b.prototype.clearSticky=function(){this.storeSubnavContainer.classList.remove("_store-subnav-desktop_style_subnav-sticky__227qt");this.storeSubnavPlaceholder.style.display="none";this.storeSubnavResizeObserver.unobserve(this.storeSubnavPlaceholder);this.storeSubnavContainer.style.width="100%"};b.prototype.toggleL1NodeVisibilityOnOverflow=function(){var a,c=this.isRTL?this.storeSubnavContainer.getBoundingClientRect().left:
this.storeSubnavContainer.getBoundingClientRect().right;try{for(var d=f.__values(this.storeSubnavL1Nodes),e=d.next();!e.done;e=d.next()){var k=e.value;(this.isRTL?k.getBoundingClientRect().left<c:k.getBoundingClientRect().right>c)?k.style.visibility="hidden":k.style.visibility="visible"}}catch(l){var h={error:l}}finally{try{e&&!e.done&&(a=d.return)&&a.call(d)}finally{if(h)throw h.error;}}};return b}(),E;(function(b){b.L1Node="L1Node";b.Subnav="Subnav"})(E||(E={}));var z=E;F._operationNames=["postMetricsToCloudwatch"];
F.card=function(){return f.__awaiter(void 0,void 0,void 0,function(){var b,a,c,d,e;return f.__generator(this,function(k){b=V["default"].setup().define;a=W["default"].cardRoot;c=a.offsetTop;d=new ea(a);e=Z["default"].setup();b(z.L1Node,"mouseenter",function(h){return f.__awaiter(void 0,void 0,void 0,function(){var l,v,n,g,m,p,C,u,L,M;return f.__generator(this,function(N){switch(N.label){case 0:return l=new ca("dsk_sn"),v=new I("dsk_sn","l1_render"),n=h.event,d.setFocus(),g=new da(n.target),m=g.getFlyoutState(),
g.alignDropdownFlyout(),g.alignFlyoutArrow(),p=K.extractFlyoutKeyDataFromHTMLElement(g.getRawNavKey()),[4,K.getHTMLForSubnavKey(p,l)];case 1:return C=N.sent(),u=g.setHTMLAndFlyoutStateForL1FlyoutAndGetNextState(C),L=m===u?x.UNCHANGED:m===q.LOADING&&u===q.ERROR?x.FAIL:m===q.LOADING&&u===q.LOADED?x.SUCCESS:x.UNKNOWN,v.endTimerWithSuffixAndPublishToCSM(L),M=g.getReftag(),l.createAndAddImpressionMetric(M+"_"+u),u===D.ERROR&&l.createAndAddBooleanMetric("all_l1_render_"+u),l.batchPostMetrics(e.postMetricsToCloudwatch),
[2]}})})});b(z.L1Node,"mouseleave",function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(h){d.clearFocus();return[2]})})});b(z.Subnav,"scroll",function(){return f.__awaiter(void 0,void 0,void 0,function(){var h;return f.__generator(this,function(l){(h=y["default"].pageYOffset>=c)?d.setSticky():d.clearSticky();return[2]})})});b(z.Subnav,"resize",function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(h){d.toggleL1NodeVisibilityOnOverflow();
return[2]})})});return[2]})})}});
